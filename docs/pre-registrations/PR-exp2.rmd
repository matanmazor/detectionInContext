---
title             : "Detection in Context, Exp. 2 - pre-registration document"
shorttitle        : "Detection in Context, Exp. 2 - pre-registration document"

author: 
  - name          : "Matan Mazor"
    affiliation   : "1,2"
    corresponding : yes    # Define only one corresponding author
    address       : "Malet Street, London WC1E 7HX"
    email         : "mtnmzor@gmail.com"
  #   role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
  #     - Conceptualization
  #     - Writing - Original Draft Preparation
  #     - Writing - Review & Editing
  
  - name          : "Matthew Goldreich"
    affiliation   : "1"
    
  - name          : "Clare Press"
    affiliation   : "1,2"
    # role:
    #   - Writing - Review & Editing

affiliation:
  - id            : "1"
    institution   : "Birkbeck, University of London"
  - id            : "2"
    institution   : "Wellcome Centre for Human Neuroimaging, UCL"


abstract: |
  
  
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : ["r-references.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_word
---

```{r setup, include = FALSE}
library("papaja")
library('pwr')
r_refs("r-references.bib")
knitr::opts_chunk$set(fig.pos = "!H", out.extra = "")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

# Motivation

In a previous experiment, participants performed a letter detection task, where on different trials the target letter (e.g., 'S') was sometimes congruent and sometimes incongruent with a context word (for example, S is congruent with KI_S, but incongruent with FL_G). As expected, decisions about letter absence were overall slower than decisions about letter presence. Furthermore, subjects more readily detected the presence of a letter when the context was congruent, compared to incongruent with the target letter. However, we found no effect of context congruency on the time taken to infer the absence of a target. Specifically, subjects did not infer absence earlier in a congruent context although they could have safely done so without increasing their miss rate. 

Importantly, reaction times in Exp. 1 were slow overall (3-4 seconds). This is likely to be due to the gradual stimulus presentation, where the target letter slowly emerged from the background, reaching half the maximum visibility (staircased separately for each participant) only after two and a half seconds. In a follow-up experiment, we wish test the generalizability of our findings to a context where visibility is constant throughout the trial, such that decisions can be made faster.


# Methods
We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study. Changes relative to Exp. 1 appear in **bold letters**.<!-- 21-word solution (Simmons, Nelson & Simonsohn, 2012; retrieved from http://ssrn.com/abstract=2160588) -->

## Participants

The research complies with all relevant ethical regulations, and was approved by the Research Ethics Committee of Birkbeck, University of London (study ID number 1812000). Participants will be recruited via Prolific, and will give informed consent prior to their participation. To be eligible to take part in this study, their Prolific approval rate will need to be 95% or higher, their reported first language English, and their age between 18 and 60. We will  collect data until we reach **300** included participants (after applying our pre-registered exclusion criteria). The entire experiment will take 11 minutes to complete. Participants will be paid £1.38 for their participation, equivalent to an hourly wage of £7.50.

## Procedure

Participants will detect the presence or absence of a target letter (S or A, in different blocks) in a patch of dynamic grayscale noise presented at 15 frames per second. In each frame, noise will be generated by randomly sampling grayscale values from a target image $I$. Specifically, for each pixel $S_{ij}$, we will display the grayscale value for the corresponding pixel in the original image $I_{ij}$ with some probability $p$, and the grayscale value of a randomly chosen pixel $I_{i'j'}$ with probability $1-p$. On target-absent trials, $p$ will be set to $0$, such that they grayscale values of all pixels will be randomly shuffled. On target-present trials, **$p$ will be calibrated online to achieve performance levels of around 80%, following a 1-up-3-down procedure, starting at $v=0.2$ ** and following a multiplicative set size of $0.9$, which will move closer to 1 following each change direction in the calibration process, **with a reset to $0.9$ after the second block, to allow separate staircasing for each letter**. Responses will be delivered using the F and G keyboard keys, and response-mapping will be counterbalanced across subjects.

```{r design, echo=FALSE, fig.cap="Experimental design. Top left: target visibility as a function of frame number for in target present (blue) and target absent (red) trials. Bottom left: trial structure in practice trials. Top right: trial structure in the main blocks of the experiment, in S- and A- context trials. Bottom right: overall experiment structure. ", out.width = '75%'}
knitr::include_graphics("figures/design2.png")
```

After reading the instructions, participants will complete four practice trials. In case their accuracy in these four practice trials falls below 3/4, they will be reminded of task instructions and given additional practice trials, until they reach the desired accuracy level. Otherwise, they will continue to the main part of the experiment. Here, their task will be exactly the same, but the noise patch will be embedded in a congruent or incongruent context word. For example, when searching for the letter S, the context word CA_H (cash) is congruent but the context word FL_G (flag) is not (see Fig. \@ref(fig:design), upper right panel). To make sure participants are primed with the correct reading of the context word, an image of its meaning will be presented for 500 ms following the fixation cross and prior to the presentation of the noise display.

The main part of the experiment will comprise four blocks of 16 trials. For approximately half of the participants, in blocks 1 and 2 the target letter will be S and in blocks 3 and 4 it will be A. The order of letters will be reversed for the other half. All context words will be presented twice: once when detecting the letter S and once when detecting the letter A. As a result, all context words will be presented both as congruent and as incongruent contexts for the target letter. Overall, there will be 32 context words: 16 where the missing letter is an A and 16 where it is an S. All words will be 4- or 5-letter nouns with S or A in one of the central positions (i.e., position 2 or 3 in 4-letter words and position 3 in 5-letter words).

### Randomization

The order and timing of experimental events will be determined pseudo-randomly by the Mersenne Twister pseudorandom number generator, initialized in a way that ensures registration time-locking [@mazor2018novel]. 

## Data analysis

### Rejection criteria

Participants will be excluded if their accuracy falls below 50%. We will also exclude participants for having extremely fast or slow reaction times in one or more of the tasks (below 100 milliseconds or above 5 seconds in more than 25% of the trials). 

Trials with response time below 100 milliseconds or above 5 seconds will be excluded from the response-time analysis.

### Hypotheses and analysis plan

This study is designed to test several hypotheses about the effects of expectation and context on visual detection, with a focus on the timing of decisions to terminate evidence accumulation in the absence of a target as a potential window into self-modeling and metacognitive knowledge about perception and attention.

*Hypothesis 1 (PRESENCE/ABSENCE RESPONSE TIME)*: We will test the null hypothesis that response times are similar for target-absent and target-present responses, aiming to replicate the finding that decisions about the absence of a target are slower than decisions about its presence [@mazor2021metacognitive; @mazor2020distinct]. This will be tested using a paired t-test on the median individual level-response times. 

*Hypothesis 2 (CONTEXT IN PRESENCE)*: We will test the null hypothesis that target-present response times are similar when the context word matches or does not match the target letter. This will be tested using a paired t-test on the median individual level-response times .

*Hypothesis 3 (CONTEXT IN ABSENCE)*: We will test the null hypothesis that response times in target-absent responses are similar when the context word matches or does not match the target letter. This will be tested using a paired t-test on the median individual level-response times.

*Hypothesis 4 (CONTEXT RESPONSE INTERACTION)*: We will test the null hypothesis that the effect of context on reaction time is similar in target-absent and target-present responses. This will be tested by performing a group-level t-test on the subject-level contrast $(median(RT_{P,C})-median(RT_{P,I}))-(median(RT_{A,C})-median(RT_{A,I}))$ Where $P$, $A$, $C$ and $I$ stand for present, absent, congruent (matching) and incongruent (non-matching), respectively.

*Hypothesis 5 (SENSITIVITY)*: We will test the null hypothesis that sensitivity (measured as d') is equal in matching and non-matching contexts. To allow the extraction of d' for participants who committed no false-alarms or misses, we will add 0.5 to miss, hit, false-alarm and correct rejection counts [@snodgrass1988pragmatics].

*Hypothesis 6 (CRITERION)*: We will test the null hypothesis that decision criterion (measured as c) is equal in matching and non-matching contexts. To allow the extraction of a decision criterion for participants who committed no false-alarms or misses, we will add 0.5 to miss, hit, false-alarm and correct rejection counts [@snodgrass1988pragmatics].

*Hypothesis 7 (ABSENCE RESPONSE TIME)*: **We will test the null hypothesis that target-absent response times are similar in Experiments 1 and 2.  This will be tested using a  t-test for two samples on the median individual level-response times for target absence in Exp. 1 and 2. Since target-absent trials are identical in Experiments 1 and 2, a difference would indicate an indirect effect of target-present trials on target-absent response times, indicative of a dynamic adjustment of subjects' evidence accumulation termination heuristic.**

## Sample size justification

In Exp. 1, stansardized effect sizes for Hypotheses 2 (effect of context congruency on RT in target-present trials) and 4 (interaction between context congruency and target presence with respect to RT) were $0.19$ and $0.22$, respectively. Since our focus is on these effects of context congruency on decision time, and since these were the weakest effects in Exp. 1, we decided to test enough participants to obtain sufficient statistical power to test these hypotheses with high sensitivity. With 300 participants, we will have a statistical power of 93% to detect effect sizes of $0.2$ standard deviations.


```{r power, echo=FALSE, fig.cap="Power curve for a two-tailed paired t-test with a true effect size of 0.2 standard devitations. With 300 participants, we will have 93% statistical power under such settings. ", out.width = '75%'}
Exp2.pwr <- pwr.t.test(n=300,d=0.2,type='paired');
plot(Exp2.pwr)
```

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
